(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-19"],{"0f41":function(t,e,i){},"490e":function(t,e,i){"use strict";var s=i("ade5"),o=i.n(s);o.a},"582a":function(t,e,i){},5858:function(t,e,i){"use strict";var s=i("582a"),o=i.n(s);o.a},"58c1":function(t,e,i){"use strict";i.r(e);var s,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dwd-page",{staticClass:"merchant-page",attrs:{"is-header":""}},[t.shopAllBtnStatus&&t.listData.length>0?i("div",{staticClass:"shop-all-btn",on:{click:t.allShopBtn}},[i("div",{staticClass:"btn-text"},[t._v("全部商品")]),i("div",{staticClass:"btn-e-text"},[t._v("PRODUCTS")]),i("dwd-icon",{staticClass:"more-product-icon",attrs:{type:"more",size:40}})],1):t._e(),i("dwd-scroll",{staticClass:"merchant-scroll",attrs:{finished:t.finished,"list-len":t.listData.length,"is-loading":t.isLoading,"finished-tip":t.finishedTip,"immediate-check":t.scrollCheck},on:{onScrollToLower:t.onScrollToLower,getScrollTop:t.getScrollTop}},[i("div",{staticClass:"merchant-desc"},[i("div",{staticClass:"merchant-top"},[i("div",{staticClass:"merchant-head-bg",style:{backgroundImage:"url("+t.headerData.logo+"),center center no-repeat;"}}),i("div",{staticClass:"merchant-name-block"},[i("div",{staticClass:"merchant-name-left"},[i("div",{staticClass:"merchant-img"},[i("img",{attrs:{src:t.headerData.logo,alt:""}})]),i("div",{staticClass:"merchant-name-desc"},[i("div",{staticClass:"merchant-name-text line-1"},[t._v("\n                "+t._s(t.headerData.name)+"\n              ")]),i("div",{staticClass:"merchant-add-text line-1"},[t._v("\n                "+t._s(t.headerData.province)+" "+t._s(t.headerData.city)+"\n              ")])])]),t.isHSQ?i("div",{staticClass:"favorite-merchant-btn",on:{click:t.toggleFavorite}},[i("div",{staticClass:"favorite-icon"},[i("dwd-icon",{class:t.iconClass,attrs:{type:t.buttonType,size:20}})],1),i("div",{staticClass:"favorite-text"},[t._v("\n              "+t._s(t.favoriteText)+"\n            ")])]):t._e()])]),i("div",{staticClass:"certificate-cell",on:{click:t.goShopaptitude}},[i("div",{staticClass:"certificate-left"},[i("img",{attrs:{src:"https://img1.haoshiqi.net/assets/hsqimg/certificate-icon.png",alt:""}}),i("div",{staticClass:"cer-text"},[t._v("工商资质")])]),i("dwd-icon",{staticClass:"icon-more",attrs:{type:"more",size:20}})],1),i("div",{staticClass:"merchant-info"},[t.headerData.notice?i("div",{staticClass:"merchant-brand"},[i("div",{staticClass:"brand-label"},[t._v("店铺公告：")]),i("div",{staticClass:"brand-text"},[t._v(t._s(t.headerData.notice))])]):t._e(),t.headerData.brand?i("div",{staticClass:"merchant-brand"},[i("div",{staticClass:"brand-label"},[t._v("经营品牌：")]),i("div",{staticClass:"brand-text",class:{more:t.showdownArrow}},[i("span",{staticClass:"middle-text"},[t._v(t._s(t.headerData.brand))]),t.arrowClick?i("span",{staticClass:"border"}):t._e()]),t.arrowClick?i("div",{staticClass:"left-arrow",on:{click:t.onShowAll}},[i("span",{staticClass:"text"},[t._v(t._s(t.showdownArrow?"展开":"收起"))]),i("span",{staticClass:"arrow",class:[t.showdownArrow?"":"up"]})]):t._e()]):t._e()]),t.couponList.length&&t.couponVersionSts&&t.isHSQ?i("div",{staticClass:"copple-desc",on:{click:t.showCoupon}},[i("coupon",{attrs:{"coupon-list":t.couponList,"couple-title":"店铺领券"}})],1):t._e(),t.spikeList.length>0?i("div",{staticClass:"spike-block"},[i("div",{staticClass:"list-header"},[t._v("秒杀专区 "),i("span",[t._v("SECONDS KILL ZONE")])]),i("div",{staticClass:"spike-list"},[i("c-product-col1",{attrs:{data:t.spikeData},on:{refresh:t.getMerchantInfo}})],1),t.hasMoreBtn?i("div",{staticClass:"more-spike-list",on:{click:t.toggleShowAllSpike}},[i("div",[t._v("\n            "+t._s(t.moreText)+"\n          ")]),i("dwd-icon",{class:t.triangleClass,attrs:{type:"triangle",size:10}})],1):t._e()]):t._e(),i("div",{staticClass:"product-block"},[i("div",{staticClass:"list-header"},[t._v("商品列表 "),i("span",[t._v("PRODUCT LIST")])]),i("div",{staticClass:"product-list"},[i("c-product-col2",{attrs:{data:t.productListData}})],1)])])]),t.showCoupons&&t.coupons.length?i("div",{staticClass:"popup-outbox",on:{click:t.onClose}},[i("coupon-list",{attrs:{coupon:t.coupons},on:{close:t.onClose,getCoupon:t.getCoupon}})],1):t._e(),i("conpon-toast",{directives:[{name:"show",rawName:"v-show",value:t.sucToast,expression:"sucToast"}]})],1)},a=[],n=(i("8e6e"),i("456d"),i("b54a"),i("28a5"),i("6b54"),i("ac6a"),i("bd86")),c=(i("7f7f"),i("2446")),r=i("6b9a"),l=i("0be1"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout-column2"},[i("div",{staticClass:"title"},[t._v(t._s(t.coupleTitle)+"：")]),i("div",{staticClass:"content nowrap"},t._l(t.couponList,(function(e,s){return i("div",{key:"box"+s,staticClass:"item"},[i("span",{staticClass:"text"},[t._v(t._s(e.coupon_desc))])])})),0),i("img",{staticClass:"more",attrs:{src:"https://img1.haoshiqi.net/wxapp/img/more_85508a3b09.png"}})])},p=[],d={name:"coupon",props:{couponList:{type:Array},coupleTitle:{type:String,default:"领券"}}},h=d,f=(i("ec6e"),i("2877")),v=Object(f["a"])(h,u,p,!1,null,null,null),m=v.exports,g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box"},[s("span",{staticClass:"overlay",on:{click:t.onClose}}),s("div",{staticClass:"popup-box"},[s("span",{staticClass:"title"},[t._v("优惠券")]),s("span",{staticClass:"close-box",on:{click:t.onClose}},[s("img",{staticClass:"close-img",attrs:{src:i("04b3")}})]),s("div",{staticClass:"popup-box-list"},[s("span",{staticClass:"list-title"},[t._v("可领取的优惠券")]),t._l(t.coupon,(function(e,i){return s("div",{key:"item"+i,staticClass:"popup-box-item flex-between"},[s("div",{staticClass:"pc-info"},[s("div",{staticClass:"pc-tit"},[s("span",{staticClass:"pc-num"},[t._v("¥"+t._s(e.value))]),s("span",{staticClass:"pc-text"},[t._v(t._s(e.title))])]),s("span",{staticClass:"pc-desc"},[t._v(t._s(e.subTitle))]),s("span",{staticClass:"pc-time"},[t._v(t._s(e.time))])]),s("span",{staticClass:"pc-btn",class:[e.isRedeem?"":"disabled"],on:{click:function(s){return s.stopPropagation(),t.getCoupon(e,i)}}},[t._v(t._s(e.isRedeem?"立即领取":"已领取")+"\n        ")])])}))],2)])])},_=[],C={name:"coupon-list",props:{coupon:{type:Array,require:!0}},methods:{onClose:function(){this.$emit("close")},getCoupon:function(t,e){this.$emit("getCoupon",t,e)}}},b=C,w=(i("dccc"),Object(f["a"])(b,g,_,!1,null,"1c282f42",null)),k=w.exports,y=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},S=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pop-suc"},[s("div",[s("img",{staticClass:"icon-suc",attrs:{src:i("4c6e")}})]),s("span",{staticClass:"sub-text"},[t._v("恭喜领取成功！")])])}],x={name:"conpon-toast"},D=x,T=(i("5858"),Object(f["a"])(D,y,S,!1,null,"46417888",null)),L=T.exports,$=i("79bb"),A=i("4183"),O=i("9377"),I=i.n(O);i("4f9d");function q(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?q(i,!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):q(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var P={name:"merchant",components:(s={},Object(n["a"])(s,$["c"].name,$["c"]),Object(n["a"])(s,$["b"].name,$["b"]),Object(n["a"])(s,r["a"].name,r["a"]),Object(n["a"])(s,l["a"].name,l["a"]),Object(n["a"])(s,"coupon",m),Object(n["a"])(s,"couponList",k),Object(n["a"])(s,"conponToast",L),s),mixins:[c["a"]],data:function(){return{headerData:{logo:"",name:"",province:"",city:"",notice:"",brand:"",favorited:!1},listData:[],spikeList:[],showAllSpike:!1,pullParams:{},shopAllBtnStatus:!0,isHSQ:I.a.hsq,couponList:[],showArrow:!1,coupleTitle:"店铺领券",showdownArrow:!1,arrowClick:!1,showCoupons:!1,sucToast:!1,coupons:[],couponVersionSts:!1}},computed:{buttonType:function(){return this.headerData.favorited?"favorite-active":"favorite"},favoriteText:function(){return this.headerData.favorited?"已收藏":"收藏"},iconClass:function(){return this.headerData.favorited?"favorite-active":"favorite-no-active"},hasMoreBtn:function(){return this.spikeList.length>2},moreText:function(){return this.showAllSpike?"收起":"点击展开更多"},triangleClass:function(){return this.showAllSpike?"triangle-top":""},productListData:function(){var t=this;return{type:"c-product-col2",comment:"一行两列铺品",margin_bottom:0,margin_lr:0,margin_top:0,bg_color:"",width:200,height:200,list:this.listData||[],eventClick:function(e){t.goDetail(e)}}},spikeData:function(){var t=this;return{type:"c-product-col1",comment:"一行一列铺品",margin_bottom:0,margin_lr:0,margin_top:0,bg_color:"",width:200,height:200,is_spike:!0,list:this.showAllSpike?this.spikeList:this.spikeList.slice(0,2),eventClick:function(e){t.goDetail(e)}}}},created:function(){this.pullParams={merchantId:this.$route.query.id||138},this.getMerchantInfo(),this.getListData(),this.isHSQ?this.$version.gt("3.8.8")&&(this.couponVersionSts=!0):this.couponVersionSts=!0},mounted:function(){},methods:{pullModel:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.$api.getMerchantList.apply(this,e)},getListData:function(){this.$showLoading(),this.initPullList(),this.onScrollToLower()},getMerchantInfo:function(){var t=this;this.$api.getMerchantInfo({merchantId:this.$route.query.id||138,topicId:this.$route.query.topic_id,skuId:this.$route.query.sku_id},(function(e){var i=e.data,s=void 0===i?{}:i,o=[];s.brandList&&s.brandList.forEach((function(t){o.push(t.name)})),t.headerData={logo:s.logo,name:s.name,province:s.province,city:s.city,notice:s.notice,brand:o.join("，"),favorited:s.is_like},t.headerData.brand.length>30&&(t.arrowClick=!0,t.showdownArrow=!0),t.spikeList=t.dealSpikeList(s.activityList,1e3*e.timestamp-Date.now()),t.couponList=s.coupons||[]}),(function(t){}))},onShowAll:function(){this.showdownArrow=!this.showdownArrow},showCoupon:function(){this.showCoupons=!0,this.getCouponList()},dealSpikeList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e,s){var o=parseInt((e.all_stock-e.left_stock)/e.all_stock*100),a="",n=1;return 1e3*e.start_time+i>Date.now()?(a=e.is_subscribe?"取消提醒":"提醒我",n=1):(a="马上抢",n=2),j({},e,{index:s,tags:e.tags||[],market_price:(e.market_price/100).toFixed(2),price:t.productPrice((e.price/100).toFixed(2)),rate_percent:o,snappedUp:e.all_stock-e.left_stock,is_spike:!0,diffTime:i,title:e.name,countDownInfo:{d:0,h:0,f:0,s:0},buttonText:a,buttonStatus:n,pinActivitiesId:e.biz_id,hideCountDown:!1,showupArrow:!0,arrowClick:e.tags.toString().length>48,expired_date_text:e.expired_date_text_one})}))},dealList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var i=parseInt((e.all_stock-e.left_stock)/e.all_stock*100);return Object.assign({},e,{merchant_type:e.merchant_type,tags:(e.tags||[]).splice(0,2),market_price:(e.marketPrice/100).toFixed(2),price:t.productPrice((e.couplePrice/100).toFixed(2)),member_price:(e.member_price/100).toFixed(2),rate_percent:i,sku_id:e.skuId,thumbnail:e.skuPic,pin_activities_id:e.pinActivitiesId,title:e.coupleTitle,couple_price:t.productPrice((e.couplePrice/100).toFixed(2)),can_bought:e.canBought,left_stock:e.left_stock||e.inStock,count_limit:e.countLimit,expired_date_text:e.expired_date_text_two})}))},productPrice:function(t){var e=t.split(".");return{price_yuan:e[0],price_fen:e[1]}},goShopaptitude:function(){var t=this.$route.query.id||138;this.$forward("https://m.haoshiqi.net/index.html#shopaptitude?id=".concat(t))},toggleShowAllSpike:function(){this.showAllSpike=!this.showAllSpike,this.showAllSpike||window.scrollTo(0,250)},toggleFavorite:function(){var t=this;this.isHSQ?A["a"].getUserInfo({success:function(e){e.data.user_id?t.toggleFavoriteFunc():A["a"].login({success:function(t){},fail:function(){}})}}):this.toggleFavoriteFunc()},toggleFavoriteFunc:function(){var t=this;this.headerData.favorited?this.$api.setUnLikeMerchant({merchantIds:this.$route.query.id||138},(function(e){t.$showToast("取消收藏成功！"),t.$set(t.headerData,"favorited",!1)}),(function(t){})):this.$api.setLikeMerchant({merchantId:this.$route.query.id||138},(function(e){t.$showToast("收藏成功！"),t.$set(t.headerData,"favorited",!0)}),(function(t){}))},allShopBtn:function(){var t=0,e=this.$el;t+=e.querySelector(".merchant-top").scrollHeight,t+=e.querySelector(".certificate-cell").scrollHeight,t+=e.querySelector(".merchant-info").scrollHeight,t+=e.querySelector(".spike-block").scrollHeight,window.scrollTo(0,t)},goDetail:function(t){this.isHSQ?this.$version.gt("3.9.5")?A["a"].navigateTo({url:t.link}):this.$version.gt("3.7.6")?A["a"].navigateTo({url:"https://m.haoshiqi.net/v2/couple-detail?id=".concat(t.pinActivitiesId)}):location.href="haoshiqi://com.doweidu/couplesbuydetail?pinActivityId=".concat(t.pinActivitiesId):t.link?this.$forward(t.link):this.$forward("detail2",{id:t.pinActivitiesId})},getScrollTop:function(t){if(this.spikeList.length<1)this.shopAllBtnStatus=!1;else{var e=0,i=this.$el;e+=i.querySelector(".merchant-top").scrollHeight,e+=i.querySelector(".certificate-cell").scrollHeight,e+=i.querySelector(".merchant-info").scrollHeight,e+=i.querySelector(".spike-block").scrollHeight,this.shopAllBtnStatus=!(t>=e)}},onClose:function(){this.showCoupons=!1},getCouponList:function(){var t=this,e=this.$route.query.id||139;this.$api.getMerchantCouponlist({merchantId:e},(function(e){var i=e.data,s=i.list||[];s.length&&(s=s.map((function(t){return{isRedeem:t.usable_num,code:t.code,desc:t.usage_desc,title:t.title,subTitle:t.sub_title,value:t.value/100,time:t.enabled_time_display}}))),t.coupons=s}),(function(t){}))},getCoupon:function(t,e){if(this.isHSQ){var i=this;A["a"].getUserInfo({success:function(s){s.data.user_id?i.conponRedeem(t,e):A["a"].login({success:function(t){},fail:function(){}})}})}else this.conponRedeem(t,e)},conponRedeem:function(t,e){var i=this,s=this.coupons[e];t.isRedeem&&this.$api.codeRedeem({code:t.code,type:"0"},(function(e){t.isRedeem=t.isRedeem-1,s.isRedeem=t.isRedeem,i.sucToast=!0,setTimeout((function(){i.hideToast()}),2e3)}),(function(e){if(9310009===e.errno)return t.isRedeem=t.item-1,s.isRedeem=t.isRedeem,i.sucToast=!0,setTimeout((function(){i.hideToast()}),2e3),!0}))},hideToast:function(){this.sucToast=!1}}},R=P,H=(i("490e"),Object(f["a"])(R,o,a,!1,null,"751842fe",null));e["default"]=H.exports},ade5:function(t,e,i){},dccc:function(t,e,i){"use strict";var s=i("0f41"),o=i.n(s);o.a},ec6e:function(t,e,i){"use strict";var s=i("f0eb"),o=i.n(s);o.a},f0eb:function(t,e,i){}}]);