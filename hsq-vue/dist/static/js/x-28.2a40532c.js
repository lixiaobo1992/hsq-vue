(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-28"],{"4e22":function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"page"},[s("div",{staticClass:"search"},[s("div",{staticClass:"btn-search fr",on:{click:t.goBack}},[t._v("\n      取消\n    ")]),s("div",{staticClass:"search-input"},[s("dwd-icon",{staticClass:"icon-index-search flex-shrink",attrs:{type:"search",size:14}}),s("form",{staticClass:"search-block",attrs:{action:"javascript:void 0"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"input",attrs:{type:"search",placeholder:t.placeholder,focus:t.focus,"data-link":t.hotSearch.url},domProps:{value:t.inputValue},on:{input:[function(i){i.target.composing||(t.inputValue=i.target.value)},t.onInputValue],keyup:function(i){if(!i.type.indexOf("key")&&13!==i.keyCode)return null;t.hotSearch.url&&!t.inputValue?t.$onUrlPage(i):t.onInputSearch(i)}}})]),t.inputValue.length>1?s("div",{staticClass:"clear-icon",on:{click:function(i){return i.stopPropagation(),t.clearInput(i)}}},[s("dwd-icon",{staticClass:"icon-content flex-shrink",attrs:{type:"delete",color:"#999",size:14}})],1):t._e()],1)]),t.searchList.length?s("div",{staticClass:"search-suggest"},t._l(t.searchList,(function(i,e){return s("div",{key:e,staticClass:"search-suggest-item",attrs:{"data-value":i.keywords,"data-link":i.link,"data-index":e},on:{click:function(s){i.link?t.$onUrlPage(s):t.onHotSearch(s)}}},[s("div",{staticClass:"search-suggest-keywords"},[s("div",{domProps:{innerHTML:t._s(i.highlight.keywords)}})]),s("div",{staticClass:"search-suggest-num"},[s("div",{domProps:{innerHTML:t._s(i.highlight.item_num)}})])])})),0):[t.hotSearchList.length?s("div",{staticClass:"hotSearch"},[t._m(0),s("div",{staticClass:"row"},t._l(t.hotSearchList,(function(i,e){return s("div",{key:e,staticClass:"item",class:i.url?"url":"",attrs:{"data-link":i.url,"data-index":e,"data-value":i.value},on:{click:function(s){i.url?t.$onUrlPage(s):t.onHotSearch(s)}}},[t._v(t._s(i.value)+"\n        ")])})),0)]):t._e(),s("div",{staticClass:"history"},[s("div",{staticClass:"section"},[s("span",{staticClass:"section-text"},[t._v("最近搜过")]),t.historyList&&t.historyList.length?s("div",{staticClass:"garbage",on:{click:t.onGarbage}},[s("img",{staticClass:"garbage-img",attrs:{src:"https://img1.haoshiqi.net/miniapp/img/icon_garbage_af9fc75f34.png"}})]):t._e()]),s("div",{staticClass:"row"},t._l(t.historyList,(function(i){return s("div",{key:i,staticClass:"item",on:{click:function(s){return t.onClickHistory(i)}}},[t._v(t._s(i)+"\n        ")])})),0),t.historyList.length?t._e():s("div",{staticClass:"tip"},[t._v("暂无搜索记录")])])]],2)},a=[function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"section"},[s("span",{staticClass:"section-text"},[t._v("热门搜索")])])}],n=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=(s("7f7f"),s("2f62")),o=s("79bb"),c=s("ed08"),h=s("5d2d");function u(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function l(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?u(s,!0).forEach((function(i){Object(n["a"])(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(s).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var p="",d={components:Object(n["a"])({},o["b"].name,o["b"]),data:function(){return{historyList:[],inputValue:"",couponId:"",focus:!0,hotSearchList:[],searchList:[]}},computed:l({},Object(r["d"])({appConfig:function(t){return t.app.appConfig}}),{placeholder:function(){return this.appConfig&&this.appConfig.hotSearch&&this.appConfig.hotSearch.value||(this.isPinSku?"搜索可使用券的商品":"搜索您想找的商品")},hotSearch:function(){return this.appConfig&&this.appConfig.hotSearch},isPinSku:function(){return"couple_list"==this.$route.query.ref}}),created:function(){this.getHistory(),this.onFecthData()},methods:{onFecthData:function(){var t=this;this.$api.getHotSearch({},(function(i){var s=i.data.list;t.hotSearchList=s}),(function(t){}))},getHistory:function(){p=this.isPinSku?"skuHistoryList":"historyList",this.historyList=h["a"].get(p)||[]},clearInput:function(){this.inputValue="",this.searchList=[]},onInputValue:function(t){this.inputValue?Object(c["b"])(this.getSearchSuggest.bind(this),300)():this.searchList=[]},getSearchSuggest:function(){var t=this;this.$api.getSearchSuggest({isLoading:!1,keywords:this.inputValue},(function(i){var s=i.data.list;t.searchList=s}),(function(t){}))},onHotSearch:function(t){var i=t.currentTarget.dataset,s=i.value;i.index;this.$forward("couple-search-list",{q:s}),this.onSaveLocal(s)},goBack:function(){this.$back()},onInputSearch:function(){var t=this.inputValue;this.hotSearch.url||!this.hotSearch.value||this.value||(t=this.hotSearch.value),t.length?(this.onSaveLocal(t),this.$forward("couple-search-list",{q:t})):this.$showToast("关键字不能为空")},onGarbage:function(){var t=this;this.$showConfirm({title:"提示",message:"确定清空搜索历史吗？",callback:function(i){"cancel"!=i&&"error"!=i&&(t.historyList=[],h["a"].remove(p))}})},addHistory:function(t){var i=this.historyList.indexOf(t);i>-1&&this.historyList.splice(i,1),this.historyList.splice(0,0,t)},onClickHistory:function(t){this.addHistory(t),this.$forward("couple-search-list",{q:t}),this.onSaveLocal(t)},onSaveLocal:function(t){if(this.historyList.length?this.addHistory(t):this.historyList.push(t),this.historyList.length>10){var i=this.historyList.slice(0,10);this.historyList=i}h["a"].set(p,this.historyList,0)}}},f=d,g=(s("8e2a"),s("2877")),v=Object(g["a"])(f,e,a,!1,null,"f2b13cc6",null);i["default"]=v.exports},"8e2a":function(t,i,s){"use strict";var e=s("df23"),a=s.n(e);a.a},df23:function(t,i,s){}}]);