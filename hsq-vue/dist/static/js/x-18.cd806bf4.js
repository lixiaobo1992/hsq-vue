(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-18"],{"2bf2":function(t,e,a){"use strict";var s=a("f139"),i=a.n(s);i.a},"597e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dwd-page",{staticClass:"open-member-page",attrs:{"is-header":"","is-footer":""},scopedSlots:t._u([{key:"footer",fn:function(){return[a("div",{staticClass:"member-protocol"},[a("p",[t._v("开通即同意"),a("span",{attrs:{"data-link":"https://render.doweidu.com/p/hsq/member-service.html"},on:{click:function(e){return t.$onUrlPage(e)}}},[t._v("《好食期·好会员服务协议》")])])]),a("div",{staticClass:"open-member-footer"},[a("div",{staticClass:"total-price"},[a("span",[t._v("总价")]),a("em",[t._v("¥"+t._s(t._f("price")(t.currentCard.price)))]),a("del",[t._v("¥"+t._s(t.currentCard.market_price))])]),a("div",{staticClass:"open-btn",on:{click:t.gotoOpen}},[t._v(t._s(t.userInfo.is_new_member?"立即开通":"立即续费"))])])]},proxy:!0},{key:"sub-block",fn:function(){return[t.isShowPopup?a("div",{staticClass:"pay-success-popup"},[a("div",{staticClass:"popup-content"},[a("img",{staticClass:"success-popup-bg",attrs:{src:"https://img1.haoshiqi.net/miniapp/windows@2x_429ea3747d.png\n",alt:""}}),a("dwd-icon",{staticClass:"close-popup",attrs:{type:"delete",color:"#000",size:24},nativeOn:{click:function(e){return t.gotoMember(0)}}}),a("div",{staticClass:"content-text"},[a("p",{staticClass:"pay-status"},[t._v(t._s(t.popupStauts?"续费成功":"开通成功"))]),t.popupStauts?a("div",{staticClass:"status-duration"},[t._v("有效期延长至："+t._s(t.memberTime.end_timeText))]):a("div",{staticClass:"status-duration"},[t._v("有效期至："+t._s(t.memberTime.end_timeText)+"快去享受会员权益吧！")]),a("div",{staticClass:"status-img"},[t.popupStauts?a("img",{staticClass:"status-renew",attrs:{src:"https://img1.haoshiqi.net/miniapp/diadema@2x_8288088a36.png",alt:""}}):a("img",{staticClass:"status-open",attrs:{src:"https://img1.haoshiqi.net/miniapp/face@2x_bb0ca7c5ed.png",alt:""}})]),t.popupStauts?a("div",{staticClass:"duration-date"},[a("span",[t._v(t._s(t.memberTime.start_time))]),a("span",[t._v(t._s(t.memberTime.end_time))])]):t._e()]),a("div",{staticClass:"popup-btn",on:{click:function(e){return t.gotoMember(1)}}},[t._v("去会员中心看看>")])],1)]):t._e()]},proxy:!0}])},[a("div",{staticClass:"user-card"},[a("div",{staticClass:"user-pic"},[t.userInfo.is_new_member?t._e():a("i",{staticClass:"vip-tag-icon"}),a("div",{staticClass:"user-avatar jzimg"},[a("img",{attrs:{src:t.userInfo.avatar,alt:""}})])]),a("div",{staticClass:"user-info"},[a("p",{staticClass:"user-name"},[t._v(t._s(t.userInfo.username))]),a("div",{staticClass:"user-member-info"},[t._v(t._s(t.userInfo.sub_content))])])]),a("div",{staticClass:"member-card-box"},t._l(t.cardList,(function(e,s){return a("div",{key:s,staticClass:"member-itme"},[a("div",{staticClass:"member-item-top"},[a("p",{staticClass:"card-name"},[t._v(t._s(e.template_name))]),a("div",{staticClass:"member-price"},[a("span",{staticClass:"offer-tag"},[t._v(t._s(e.template_tips))]),a("span",{staticClass:"price"},[t._v("¥"+t._s(t._f("price")(e.price)))])])]),a("div",{staticClass:"member-desc"},[a("p",[t._v(t._s(e.template_sub_content))]),a("del",[t._v("¥"+t._s(e.market_price))])])])})),0)])},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("6b54"),a("6762"),a("2fdb"),a("bd86")),n=(a("7f7f"),a("9377")),c=a.n(n),o=a("4183"),p=a("ed08"),u=a("2ddd"),m=a("79bb"),d=a("51be");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function _(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(a,!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f=["购买好会员","续费好会员"],v={name:"member-open",components:Object(r["a"])({},m["b"].name,m["b"]),data:function(){return{type:2,isShowPopup:!1,userInfo:{},cardList:[],currentCard:{price:0,market_price:0},payment_id:0,popupStauts:0,memberTime:{start_time:"",end_time:""}}},created:function(){var t=this.$route.query,e=t.type,a=void 0===e?1:e,s=t.payment_id;this.type=1==a?2:1,this.setTitle(a-1),this.getInitData(),s&&(this.payment_id=s,this.getOrderPaySuccessPopup())},methods:{gotoMember:function(t){if(t){var e="";["dev","beta"].includes(d["a"].apiEnv)&&(e=d["a"].apiEnv+".");var a="https://m.".concat(e,"haoshiqi.net/v2/member-center"),s=this;if(c.a.hsq)return void(this.$route.query.open_tag?o["a"].navigateBack({deep:1,success:function(t){}}):o["a"].redirectTo({url:a,success:function(t){}}));if(c.a.wxapp)return void o["a"].ready((function(t){s.$route.query.open_tag?t.miniProgram.navigateBack():t.miniProgram.redirectTo({url:"/pages/redirect/redirect?url="+encodeURIComponent(a)})}));this.$forward("member-center")}else c.a.hsq?o["a"].navigateBack({deep:1,success:function(t){}}):c.a.wxapp&&o["a"].ready((function(t){t.miniProgram.navigateBack()}))},setTitle:function(t){document.title=f[t],c.a.hsq&&o["a"].setNavigationBar({title:f[t],color:"#ffffff",backgroundColor:"#333333",success:function(t){}})},gotoOpen:function(){var t=this;if(c.a.hsq){var e=[t.currentCard.template_id];o["a"].cashier({id:e.toString(),price:t.currentCard.price,type:"1",success:function(e){"failed"!=e.data.result&&(e.data.paymentId?(t.payment_id=e.data.paymentId,t.getOrderPaySuccessPopup()):o["a"].navigateBack({deep:1,success:function(t){}}))},fail:function(t){}})}else c.a.wxapp&&o["a"].ready((function(e){var a="/pages/pay/pay",s={template_id:t.currentCard.template_id,pay_type:"open-member"};a=Object(u["k"])(a,Object(u["i"])(s)),e.miniProgram.navigateTo({url:a})}))},getInitData:function(){var t=this;this.$api.hsqMemberPayInit({type:this.type},(function(e){var a=e.data,s=a.avatar,i=void 0===s?"":s,r=a.username,n=void 0===r?"":r,c=a.sub_content,o=void 0===c?"":c,u=a.is_new_member,m=void 0===u?1:u,d=a.list,l=void 0===d?[]:d;t.setTitle(m?0:1),t.userInfo={is_new_member:m,avatar:i,username:n,sub_content:o},l&&l.length&&(t.cardList=(l||[]).map((function(t){return _({},t,{market_price:Object(p["a"])(t.market_price)})})),t.currentCard=t.cardList[0])}),(function(t){}))},getOrderPaySuccessPopup:function(){var t=this;this.payment_id&&this.$api.getOrderPaySuccessPopup({paymentId:this.payment_id},(function(e){t.isShowPopup=!0;var a=e.data,s=a.renewal_status,i=a.start_time,r=a.end_time;t.memberTime={start_time:Object(u["d"])(i,"Y.M.D"),end_time:Object(u["d"])(r,"Y.M.D"),end_timeText:Object(u["d"])(r,"Y.M.D H:F:S")},t.popupStauts=s}),(function(t){return!0}))}}},b=v,g=(a("2bf2"),a("2877")),h=Object(g["a"])(b,s,i,!1,null,"1d5b4e17",null);e["default"]=h.exports},f139:function(t,e,a){}}]);