(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-22"],{"8d21":function(e,t,i){"use strict";i.r(t);var n,a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("dwd-page",{attrs:{"is-header":""}},[n("dwd-scroll",{staticClass:"page-scroll",attrs:{finished:e.finished,"list-len":e.listData.length,"is-loading":e.isLoading,"finished-tip":e.finishedTip,"immediate-check":e.scrollCheck},on:{onScrollToLower:e.onScrollToLower},model:{value:e.pullLoading,callback:function(t){e.pullLoading=t},expression:"pullLoading"}},[n("div",{staticClass:"page"},[n("div",{staticClass:"page-header"},e._l(e.typeList,(function(t){return n("div",{key:t.text,staticClass:"header-item",class:{active:e.pageType==t.typeIndex},on:{click:function(i){return e.switchHeader(t.typeIndex)}}},[n("span",[e._v(e._s(t.text))]),e.countList[t.countType]?n("span",[e._v("("+e._s(e.countList[t.countType])+")")]):e._e()])})),0),n("div",{staticClass:"list-block"},e._l(e.listData,(function(t,i){return n("div",{key:t.id,staticClass:"order-box"},[n("div",{staticClass:"order-list"},[4==e.pageType?n("div",{staticClass:"order-id"},[n("div",[n("span",[e._v("订单号：")]),n("span",{staticClass:"order-id"},[e._v(e._s(t.id))])])]):e._e(),e.isGat?n("div",{staticClass:"order-head flex-between",on:{click:function(i){return e.goMerchant(t.merchantId)}}},[n("div",{staticClass:"order-shop v-center"},[n("i",{staticClass:"icon-shop"}),n("div",{staticClass:"shop-text"},[e._v(e._s(t.merchantName))]),n("i",{staticClass:"icon-right"})]),4!=e.pageType?n("div",{staticClass:"order-status fr"},[e._v(e._s(t.statusDesc))]):e._e()]):e._e(),e._l(t.list,(function(a){return n("div",{key:a.id,staticClass:"order-item",on:{click:function(i){return e.goOrderDetail(t.id)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.thumbnail,expression:"pitem.thumbnail"}],staticClass:"order-item-image"}),n("div",{staticClass:"order-item-info"},[n("div",{staticClass:"order-title max-line-2"},[e._v(e._s(a.name))]),n("div",{staticClass:"order-info flex-between"},[n("div",{staticClass:"order-price"},[e._v("¥ "+e._s(a.price))]),n("div",{staticClass:"order-number"},[n("span",{staticClass:"order-unit"},[e._v("x")]),e._v(e._s(a.amount))])]),n("div",{staticClass:"order-skus"},e._l(a.skus,(function(t){return n("div",{key:t,staticClass:"order-sku max-line-1 f11"},[e._v(e._s(t))])})),0),4!=e.pageType?n("div",{staticClass:"order-refund"},[e._v(e._s(a.refundStatusDesc))]):e._e()]),4==e.pageType?n("div",{staticClass:"v-center oper-box"},[n("div",{staticClass:"order-refund"},[e._v(e._s(a.refundStatusDesc))]),a.refundId>0&&4==e.pageType?n("div",{staticClass:"btn-info",attrs:{"data-orderid":a.id,"data-refundid":a.refundId,"data-refundprice":t.payPrice,"data-index":i},on:{click:function(t){return t.stopPropagation(),e.goRefundDetail(a)}}},[e._v("\n                  查看退款详情\n                ")]):e._e()]):e._e()])})),4!=e.pageType?n("div",{staticClass:"sum-info"},[n("span",[e._v("共"+e._s(t.total_amount)+"件商品 小计:")]),n("span",{staticClass:"sum-price"},[e._v("¥"+e._s(t.payPrice))])]):e._e(),4!=e.pageType?n("div",{staticClass:"oper-box padding"},[e._l(e.btnTypeList,(function(a){return[t[a]?n("div",{key:a,class:e.getBtnOption(a).className,on:{click:function(n){return e.handleOrder(Object.assign({},t.btnOptions,{orderIndex:i,btnType:a}))}}},[e._v("\n                  "+e._s(e.getBtnOption(a).text)+"\n                ")]):e._e()]}))],2):e._e()],2)])})),0),e.listData.length||e.isLoading?e._e():n("div",{staticClass:"no-data"},[n("div",[n("img",{staticClass:"empty-img",attrs:{src:i("2982")}}),n("div",{staticClass:"empty-text"},[e._v("您还没有相关订单")])])])])]),n("mt-actionsheet",{attrs:{actions:e.cancelActions},model:{value:e.sheetVisible,callback:function(t){e.sheetVisible=t},expression:"sheetVisible"}})],1)},s=[],r=i("75fc"),d=(i("a481"),i("bd86")),o=(i("0b29"),i("c705")),c=i.n(o),u=(i("7f7f"),i("2446")),l=(i("9377"),i("79bb")),p=i("2ddd"),f=i("51be"),h={name:"order-list",components:(n={},Object(d["a"])(n,l["c"].name,l["c"]),Object(d["a"])(n,c.a.name,c.a),n),mixins:[u["a"]],data:function(){return{pageType:0,typeList:[{text:"全部",typeIndex:0},{text:"待付款",typeIndex:1,countType:"toPayNum"},{text:"待收货",typeIndex:2,countType:"toReceiptNum"},{text:"售后",typeIndex:4}],countList:{},hideHeader:!1,btnTypeList:["canCancel","canPay","canViewDelivery","canConfirm","canRefund","refundId"],cancelActions:[],sheetVisible:!1,finishedTip:"没有更多订单了~",isGat:!f["a"].isChannel("guanaitong")}},computed:{getOrderFunction:function(){return"4"==this.pageType?this.$api.getUserServiceOrders:this.$api.getUserOrders}},created:function(){this.pageType=this.$route.query.type||"0",this.refresh()},methods:{getOrderList:function(){this.initPullList(),this.pullParams.weights=1,this.pullParams.type=this.pageType,this.isLoading=!0,this.onScrollToLower()},pullModel:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.getOrderFunction.apply(this,t)},switchHeader:function(e){if(this.pageType!=e)switch(5!=e&&this.$router.replace({query:{type:e}}),e){case 0:case 1:case 2:case 4:this.refreshList(e);break;case 5:break}},refreshList:function(e){this.pageType=e,this.refresh()},refresh:function(){this.getHeaderData(),this.getOrderList(),this.listData=[]},afterPullData:function(){this.isLoading=!1},getBtnOption:function(e){var t="",i="",n="";switch(e){case"canCancel":t="取消订单",i="goCancelOrder",n="btn-info";break;case"canPay":t="付款",i="goPay",n="btn-sure";break;case"canViewDelivery":t="查看物流",i="goDelivery",n="btn-info";break;case"canConfirm":t="确认收货",i="goConfirm",n="btn-sure";break;case"canRefund":t="申请退款",i="goRefund",n="btn-info";break;case"refundId":t="退款详情",i="goRefundDetail",n="btn-sure";break}return{text:t,func:i,className:n}},dealList:function(e){return Object(p["h"])(e,(function(e){var t=Object(p["h"])(e.skuList,(function(e){return{name:e.name,thumbnail:e.sku_thumbnail,price:(.01*e.unit_price).toFixed(2),amount:e.amount,refundId:e.refundId,refundStatusDesc:e.refundStatusDesc,id:e.subOrderId,skus:e.attrs_desc||[]}}));return{id:e.orderId,merchantId:e.merchantId,merchantName:e.merchantName,total_amount:e.total_amount,statusDesc:e.status,list:t,payPrice:(.01*e.need_pay_price).toFixed(2),status:e.order_status||e.statusCode,canCancel:e.canCancel,canPay:e.canPay,canRefund:e.canRefund,canViewDelivery:e.canViewDelivery,canConfirm:e.canConfirm,canComment:e.canComment,canApplyRefund:e.canApplyRefund,refundId:e.refundId||0,refundStatusDesc:e.refundStatusDesc,btnOptions:{orderId:e.orderId,payPrice:e.payPrice,subOrderId:e.subOrderId,refundId:e.refundId,status:e.status,price:e.need_pay_price,pinActivitiesId:e.pin_activities_id,orderType:e.order_type,deliveryWay:e.deliveryWay,lastJoinCouple:(e.pinCountLimit||0)-(e.pinJoinCount||0)==1}}}))},getHeaderData:function(){var e=this;this.$api.getProfile({isLoading:!1},(function(t){var i=t.data,n=i.toPayNum,a=i.toReceiptNum,s=i.toRefundNum,r=i.pinOrderCnt;e.countList={pinOrderNum:r,toPayNum:n,toReceiptNum:a,toRefundNum:s},e.hideHeader=!1}),(function(e){return!0}))},cancelOrder:function(e){var t=this,i=e.reason,n=e.orderId;e.clickIndex,Object(r["a"])(this.listData);this.$showLoading({content:"订单正在取消..."}),this.$api.orderCancel({orderId:n,reason:i},(function(e){t.$hideLoading(),setTimeout((function(){t.$showToast("取消成功！")}),500),t.refresh()}),(function(e){t.$showToast("订单取消失败")}))},handleOrder:function(e){var t=e.btnType,i=this.getBtnOption(t),n=i.func;this[n](e)},goMerchant:function(e){this.$forward("merchant",{id:e})},goOrderDetail:function(e){this.$forward("order-detail",{id:e})},goRefundDetail:function(e){var t=e.refundId;t?this.$forward("order-refund-detail",{refundId:t}):this.$showToast("参数错误 refundId: ".concat(t))},goCancelOrder:function(e){var t=e.orderId,i=e.orderIndex;this.sheetVisible=!0,this.cancelActions=[{name:"我不想买了",method:this.cancelOrder,reason:1,orderId:t,clickIndex:i},{name:"信息填写错误",method:this.cancelOrder,reason:2,orderId:t,clickIndex:i},{name:"商品停售或缺货",method:this.cancelOrder,reason:3,orderId:t,clickIndex:i},{name:"其他原因",method:this.cancelOrder,reason:4,orderId:t,clickIndex:i}]},goPay:function(e){var t=e.orderId,i=e.pinActivitiesId,n=e.lastJoinCouple,a=e.price,s=e.orderType;this.$forward("".concat(window.location.origin,"/index.html#order_pay?orderIds=").concat(t,"&lastJoinCouple=").concat(n,"&price=").concat(a,"&pinActivitiesId=").concat(i,"&orderType=").concat(s))},goDelivery:function(e){var t=e.orderId,i=e.deliveryWay,n=2==i?"order_delivery2b":"order_delivery";this.$forward("".concat(window.location.origin,"/index.html#").concat(n,"?orderid=").concat(t))},goConfirm:function(e){var t=this,i=(this.pageType,e.orderId);Object(r["a"])(this.listData);this.$showConfirm({title:"确认已经收到货了吗？",message:"请务必在已收货的情况下进行确认！",confirmButtonText:"确认收货",cancelButtonText:"取消",callback:function(e){"cancel"!=e&&"error"!=e&&(t.$showLoading(),t.$api.confirmReceived({orderId:i},(function(e){t.$hideLoading(),setTimeout((function(){t.$showToast("确认收货成功！")}),1e3),t.refresh()}),(function(e){t.$showToast("确认收货失败")})))}})},goRefund:function(e){var t=e.orderId,i=e.subOrderId,n=e.refundPrice;this.$forward("order-refund",{orderId:t,subOrderId:i,refundPrice:n})}}},m=h,v=(i("ef22"),i("2877")),y=Object(v["a"])(m,a,s,!1,null,"0284a00c",null);t["default"]=y.exports},aab5:function(e,t,i){},ef22:function(e,t,i){"use strict";var n=i("aab5"),a=i.n(n);a.a}}]);